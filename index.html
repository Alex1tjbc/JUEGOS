<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mesero Pro: Realismo Total</title>
    <style>
        :root { --madera: #5d4037; --tablero: #d7ccc8; }
        body { 
            margin: 0; padding: 0; overflow: hidden; 
            background: #1a1a1a; font-family: 'Segoe UI', sans-serif; 
            perspective: 1000px; /* Efecto 3D */
        }
        
        #escenario {
            width: 100vw; height: 100vh;
            display: flex; align-items: center; justify-content: center;
        }

        /* El Tablero FÃ­sico */
        #tablero {
            width: 90vw; height: 120vw;
            background: var(--tablero);
            background-image: radial-gradient(circle, rgba(255,255,255,0.5) 1px, transparent 1px);
            background-size: 20px 20px;
            border: 15px solid var(--madera);
            border-radius: 20px;
            position: relative;
            box-shadow: 0 50px 100px rgba(0,0,0,0.5);
            transition: transform 0.1s ease-out;
        }

        /* Agujeros Realistas */
        .hoyo {
            position: absolute; width: 70px; height: 70px;
            background: #000; border-radius: 50%;
            box-shadow: inset 0 10px 20px rgba(0,0,0,1), 0 2px 5px rgba(255,255,255,0.2);
            transform: translate(-50%, -50%);
        }

        /* La Pelota que Rueda */
        #pelota {
            width: 50px; height: 50px;
            position: absolute; transform: translate(-50%, -50%);
            font-size: 40px; display: flex; align-items: center; justify-content: center;
            z-index: 10; transition: transform 0.05s linear;
        }

        #sombra {
            position: absolute; width: 50px; height: 20px;
            background: rgba(0,0,0,0.3); border-radius: 50%;
            transform: translate(-50%, 15px); filter: blur(5px);
            z-index: 5;
        }

        #ui { position: fixed; top: 20px; width: 100%; text-align: center; color: var(--madera); z-index: 100; pointer-events: none; }
        #timer { font-size: 3.5rem; font-weight: bold; margin: 0; }
        
        .overlay {
            position: fixed; top:0; left:0; width:100%; height:100%;
            background: rgba(0,0,0,0.85); display: flex; flex-direction: column;
            align-items: center; justify-content: center; z-index: 1000; color: white;
        }
        .btn { padding: 20px 60px; font-size: 1.5rem; background: #8d6e63; color: white; border: none; border-radius: 50px; cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
    </style>
</head>
<body>

<div id="ui">
    <p id="lvl-nom">NIVEL 1</p>
    <h1 id="timer">15</h1>
</div>

<div id="escenario">
    <div id="tablero">
        <div id="agujeros"></div>
        <div id="sombra"></div>
        <div id="pelota">âš½</div>
    </div>
</div>

<div id="intro" class="overlay">
    <h1 style="font-size: 3rem; margin-bottom: 10px;">MESERO LOCO</h1>
    <p style="font-size: 1.2rem; text-align: center; padding: 0 20px;">
        SostÃ©n el celular plano.<br>Â¡No dejes que ruede al hoyo!
    </p>
    <button class="btn" onclick="iniciar()">Â¡VAMOS!</button>
</div>

<script>
    let x = 50, y = 20, vx = 0, vy = 0, rot = 0;
    let incliX = 0, incliY = 0, activo = false;
    let nivelActual = 0, segundos = 15;

    const frasesPerder = [
        "Â¡Me recargo en la pared, perdiste!",
        "Â¡Me quiero volver chango!",
        "Â¡Casi casi! AsÃ­ no vas, vas... Â¡Animo para la otra!",
        "Â¡QuÃ© bÃ¡rbaro! Tienes manos de mantequilla."
    ];

    const frasesGanar = [
        "Â¡AquÃ­ tenemos a un ganador!",
        "Â¡Vean quÃ© bonito es ganar!",
        "Â¡Eso es tener estilo, mesero de lujo!"
    ];

    const niveles = [
        { obj: "âš½", nom: "ENTRENAMIENTO", t: 15, dif: 0.6, hoyos: [{x:50, y:50}] },
        { obj: "ðŸ€", nom: "DIFICULTAD MEDIA", t: 15, dif: 0.9, hoyos: [{x:50, y:50}] },
        { obj: "ðŸŽ±", nom: "BILLAR EXPERTO", t: 20, dif: 1.2, hoyos: [{x:25, y:25}, {x:75, y:75}] },
        { obj: "ðŸ’£", nom: "Â¡CUIDADO EXTREMO!", t: 25, dif: 1.5, hoyos: [{x:50, y:20}, {x:50, y:80}, {x:50, y:50}] }
    ];

    function hablar(lista) {
        window.speechSynthesis.cancel();
        const frase = lista[Math.floor(Math.random() * lista.length)];
        let m = new SpeechSynthesisUtterance(frase);
        m.lang = 'es-MX';
        m.pitch = 1.2; // Un poco mÃ¡s agudo para sonar mÃ¡s humano
        m.rate = 1.0;  // Velocidad normal
        window.speechSynthesis.speak(m);
    }

    async function iniciar() {
        if (typeof DeviceOrientationEvent.requestPermission === 'function') {
            const permission = await DeviceOrientationEvent.requestPermission();
            if (permission === 'granted') arrancar();
        } else { arrancar(); }
    }

    function arrancar() {
        document.getElementById('intro').style.display = 'none';
        activo = true;
        window.addEventListener('deviceorientation', e => {
            incliX = e.gamma; 
            incliY = e.beta;
        });
        cargarNivel();
        loop();
    }

    function cargarNivel() {
        const n = niveles[nivelActual];
        document.getElementById('lvl-nom').innerText = n.nom;
        document.getElementById('pelota').innerText = n.obj;
        segundos = n.t;
        
        const hCont = document.getElementById('agujeros');
        hCont.innerHTML = '';
        n.hoyos.forEach(h => {
            let div = document.createElement('div');
            div.className = 'hoyo';
            div.style.left = h.x + "%";
            div.style.top = h.y + "%";
            hCont.appendChild(div);
        });
        
        hablar(["Nivel " + (nivelActual + 1) + ". " + n.nom]);
        timer();
    }

    function timer() {
        if (!activo) return;
        document.getElementById('timer').innerText = segundos;
        if (segundos <= 0) {
            nivelActual++;
            if (nivelActual < niveles.length) cargarNivel();
            else { activo = false; hablar(["Â¡Ganaste todo! QuÃ© bonito es ganar."]); alert("Â¡CAMPEÃ“N!"); location.reload(); }
        } else {
            segundos--;
            setTimeout(timer, 1000);
        }
    }

    function loop() {
        if (!activo) return;

        let d = niveles[nivelActual].dif;
        vx += incliX * 0.05 * d;
        vy += incliY * 0.05 * d;
        vx *= 0.95; vy *= 0.95;
        x += vx * 0.2; y += vy * 0.2;

        // RotaciÃ³n de la pelota para que parezca que RUEDA
        rot += (vx + vy) * 2;

        // Visuales
        const p = document.getElementById('pelota');
        const s = document.getElementById('sombra');
        const t = document.getElementById('tablero');

        p.style.left = x + "%";
        p.style.top = y + "%";
        p.style.transform = `translate(-50%, -50%) rotate(${rot}deg)`;
        
        s.style.left = x + "%";
        s.style.top = y + "%";

        // InclinaciÃ³n visual del tablero (3D)
        t.style.transform = `rotateX(${-incliY*0.5}deg) rotateY(${incliX*0.5}deg)`;

        // Colisiones con hoyos
        niveles[nivelActual].hoyos.forEach(h => {
            let dist = Math.sqrt(Math.pow(x - h.x, 2) + Math.pow(y - h.y, 2));
            if (dist < 6) morir();
        });

        // ColisiÃ³n con bordes
        if (x < 5 || x > 95 || y < 5 || y > 95) morir();

        requestAnimationFrame(loop);
    }

    function morir() {
        activo = false;
        hablar(frasesPerder);
        setTimeout(() => location.reload(), 2000);
    }
</script>
</body>
</html>
